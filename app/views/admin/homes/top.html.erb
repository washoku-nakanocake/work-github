<div class="container">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h3 mb-0">管理者トップ（注文履歴一覧）</h1>
  </div>

  <% if @orders.present? %>
    <div class="card">
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-hover mb-0 align-middle">
            <thead class="thead-light">
              <tr>
                <th scope="col">購入日時</th>
                <th scope="col">購入者</th>
                <th scope="col" class="text-center">注文個数</th>
                <th scope="col" class="text-center">ステータス</th>
              </tr>
            </thead>
            <tbody>
              <% @orders.each do |o| %>
                <tr>
                  <td><%= link_to((o.created_at.strftime('%Y-%m-%d %H:%M') rescue o.created_at),
                          admin_order_path(o), class: "text-reset text-decoration-none") %>
                  </td>
                  <%# if customer = nil, return nil、普通はありえないことなんですが、 念の為 if nil show "-"" にします %>
                  <td><%= [o.customer&.last_name, o.customer&.first_name].compact.join(' ').presence || "—" %></td>
                  <td class="text-center"><%= o.order_details.sum(:amount) %></td>
                  <td class="text-center">
                    <span class="badge badge-secondary">
                      <%= t("enums.order.status.#{o.status}", default: o.status) %>
                    </span>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="mt-3 d-flex justify-content-center">
      <%= paginate @orders if respond_to?(:paginate) %>
    </div>
  <% else %>
    <div class="alert alert-info mb-0">注文データがありません。</div>
  <% end %>
</div>